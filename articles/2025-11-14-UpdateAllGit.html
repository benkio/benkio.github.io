<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-12-02 Tue 13:10 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>scala-cli Script to Update All Git Repos</title>
<meta name="author" content="Enrico Benini" />
<meta name="description" content="scala-cli Script to Update All Git Repos" />
<meta name="keywords" content="scala-cli Script to Update All Git Repos" />
<meta name="generator" content="Org Mode" />
<link rel="shortcut icon" href="../images/favicon.ico" type="image/x-icon">
<link rel="icon" href="../images/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="../css/main.css">
<link rel="stylesheet" href="../css/blog.css">
<link rel="stylesheet" href="../css/article.css">
<script>
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
// @license-end
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">scala-cli Script to Update All Git Repos</h1>
<nav id="outline-container-navbar" class="outline-2 navbar bg-dark border-bottom border-body navbar-fixed-top navbar-expand-lg bg-body-tertiary">
<h2 id="navbar">Blog</h2>
<div class="outline-text-2" id="text-navbar">
<a target="_self" class="navbar-brand" href="/index.html">
  <img class="img-circle rounded-circle" src="https://www.gravatar.com/avatar/aa7f68a32b011ac94698a7a1cb16ffc8?s=200" width="50px"/>
</a>
<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
  <span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarSupportedContent">
  <ul class="navbar-nav me-auto mb-2 mb-lg-0 mx-2">
    <li class="nav-item mx-2"> <a class="nav-link fs-4 active"        aria-current="page" target="_self" href="/blog.html">Blog</a> </li>
    <li class="nav-item mx-2"> <a class="nav-link fs-4 "        aria-current="page" target="_self" href="/articles.html">Articles</a> </li>
    <li class="nav-item mx-2"> <a class="nav-link fs-4 "        aria-current="page" target="_self" href="/books.html">Books</a> </li>
    <li class="nav-item mx-2"> <a class="nav-link fs-4 " aria-current="page" target="_self" href="/albums.html">Albums</a> </li>
    <li class="nav-item mx-2"> <a class="nav-link fs-4 "        aria-current="page" target="_self" href="/NoteTrainer/NoteTrainer.html">Note Trainer</a> </li>
  </ul>
</div>
</div>
</nav>
<div id="outline-container-Article" class="outline-2 row container p-4">
<h2 id="Article">scala-cli Script to Update All Git Repos</h2>
<div class="outline-text-2" id="text-Article">
<p>
<b>Created: <span class="timestamp-wrapper"><span class="timestamp">&lt;2025-11-14 Fri&gt;</span></span></b>
</p>
</div>
<div id="outline-container-ArticleAbstract" class="outline-3">
<h3 id="ArticleAbstract">Abstract</h3>
<div class="outline-text-3" id="text-ArticleAbstract">
<p>
We all have multiple repos on our machine, either for fun or profit,
and when we have to create a branch from <code>main</code> we often have to
update it to latest version. Plus, there are orphan remote branch
references we want to remove here and there. Sure we can do it
manually, but how about an automated script?
</p>
</div>
</div>
<div id="outline-container-ArticleContent" class="outline-3">
<h3 id="ArticleContent">Content</h3>
<div class="outline-text-3" id="text-ArticleContent">
</div>
<div id="outline-container-orgbc1c670" class="outline-4">
<h4 id="orgbc1c670">Manual</h4>
<div class="outline-text-4" id="text-orgbc1c670">
<p>
As per abstract, we can do it manually every time we branch by simply
do:
</p>
<ul class="org-ul">
<li><code>git pull origin main</code></li>
<li><code>git fetch --prune</code></li>
</ul>

<p>
And then branch from there. However, that's tedious and I tend to
forget about it.
</p>

<p>
So I thought about a script to navigate my home directory
recursively in search of git repos, and simply run those
commands. Nothing more nothing less.
</p>
</div>
</div>
<div id="outline-container-org44cf72d" class="outline-4">
<h4 id="org44cf72d">The Script</h4>
<div class="outline-text-4" id="text-org44cf72d">
<p>
With <a href="https://scala-cli.virtuslab.org/">scala-cli</a> we can finally use Scala as scripting language, far
better then any bash, python or JavaScript in my opinion.
</p>

<p>
In addition, with the <a href="https://github.com/com-lihaoyi">lihaoyi</a> libraries ecosystem, we get a convenient
way to deal with common tasks, such as: SQL, OS IO, HTTP&#x2026;
</p>

<p>
In this case, the script is super simple and just uses the <a href="https://github.com/com-lihaoyi/os-lib">os-lib</a>.
</p>

<script src="https://gist.github.com/benkio/dbb9523529c875b5472a89eb391df7b4.js"></script>
</div>
</div>
<div id="outline-container-orgbb4b8ed" class="outline-4">
<h4 id="orgbb4b8ed"><span class="timestamp-wrapper"><span class="timestamp">&lt;2025-12-02 Tue&gt; </span></span> - Edit</h4>
<div class="outline-text-4" id="text-orgbb4b8ed">
<p>
As I added it into my <a href="https://github.com/benkio/nix-config/blob/a860ea55ee4fee0bad8b5c2c7b8baf8b074fa164/homeCommon/programs/bash.nix#L14-L24">update alias</a> and it runs every time I update all the system I want it to be more performant.
</p>

<p>
Therefore, I make the update paraller by using scala `Future`. Now the output it all mixed in, but at least it terminates in seconds (especially if you have quite some repos to update).
</p>

<p>
I could have used Typelevel, IO and so on, but I don't see this to evolve much further then that. So no need to add more dependencies in.
</p>
</div>
</div>
</div>
<div id="outline-container-ArticleConclusions" class="outline-3">
<h3 id="ArticleConclusions">Conclusions</h3>
<div class="outline-text-3" id="text-ArticleConclusions">
<p>
It works great to me and I recommend you to have it
on your machine, and run it once in a while. Maybe even with a cron job
or similar.
</p>

<p>
In my case, I added it to <a href="https://github.com/benkio/nix-config/blob/78454ac059053844fceb2191cf4c0bc122cacc4e/homeCommon/gists.nix">my nix configuration</a>. That's a way to be
sure that it will be there and probably shouldn't be too hard to
schedule a run every week
</p>

<p>
I hope this showed you how scripting with Scala can be done with a
practical application. Now go and unleash your power, do your worst
with scripting.
</p>
</div>
</div>
</div>
<div id="outline-container-ShareButtons" class="outline-2 row container p-4">
<h2 id="ShareButtons">Share Buttons</h2>
<div class="outline-text-2" id="text-ShareButtons">
<!-- AddToAny BEGIN -->
<hr>
<div class="a2a_kit a2a_kit_size_32 a2a_default_style">
<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
<a class="a2a_button_facebook"></a>
<a class="a2a_button_twitter"></a>
<a class="a2a_button_whatsapp"></a>
<a class="a2a_button_telegram"></a>
<a class="a2a_button_linkedin"></a>
<a class="a2a_button_email"></a>
</div>
<script async src="https://static.addtoany.com/menu/page.js"></script>
<!-- AddToAny END -->

<script type="text/javascript">
$(function() {
  $('#text-table-of-contents > ul li').first().css("display", "none");
  $('#text-table-of-contents > ul li').last().css("display", "none");
  $('#table-of-contents').addClass("visible-lg")
});
  document.getElementById("content").classList.add("container-fluid","p-0");
  document.getElementById("text-navbar").classList.add("container-fluid");
  document.getElementById("outline-container-navbar").setAttribute("data-bs-theme", "dark");
  document.getElementById("text-Article").classList.add("text-center");
  $('.outline-3').addClass("m-auto").addClass("col-10");
  document.getElementById("text-ShareButtons").classList.add("m-auto", "col-10");
</script>
</div>
</div>
</div>
</body>
</html>
