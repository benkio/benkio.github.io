<!doctype html>
<html lang="en">
<head>
<title>Static Personal Website with Org Mode</title>
<!-- 2021-09-09 Thu 22:02 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="Org-mode">
<meta name="author" content="benkio">

<link  href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/js/bootstrap.min.js"></script>
<style>body { margin-bottom: 0px; }</style><script>
$(function() {
    'use strict';

    $('.bs-docs-sidebar li').first().addClass('active');

    $(document.body).scrollspy({target: '.bs-docs-sidebar'});

    $('.bs-docs-sidebar').affix();
});
</script><link rel="shortcut icon" href="../../images/favicon.ico" type="image/x-icon">
<link rel="icon" href="../../images/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="stylesheet" href="../css/main.css">
<link rel="stylesheet" href="../css/blog.css">
<link rel="stylesheet" href="../css/article.css">
</head>
<body>
<div id="content" class="container">
<div class="row"><div class="col-md-3 col-md-push-9"><nav id="table-of-contents">
<div id="text-table-of-contents" class="bs-docs-sidebar">
<ul class="nav">
<li><a href="#navbar">Blog</a></li>
<li><a href="#Article">Static Personal Website with Org Mode</a>
<ul class="nav">
<li><a href="#ArticleAbstract">Abstract</a></li>
<li><a href="#ArticleContent">Content</a>
<ul class="nav">
<li><a href="#ArticleContentFeatures">Features</a>
<ul class="nav">
<li><a href="#ArticleContentFeaturesHTML">Autogenerated HTML and Org-mode typing comfort</a></li>
<li><a href="#ArticleContentFeaturesDynamic">Article List and Blog Dynamic Content</a></li>
<li><a href="#ArticleContentFeaturesPagination">Pagination</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ArticleConclusions">Conclusions</a></li>
</ul>
</li>
<li><a href="#ShareButtons">Share Buttons</a></li>
</ul>
</div>
</nav>
</div><div class="col-md-9 col-md-pull-3"><h1 class="title">Static Personal Website with Org Mode</h1>

<div id="outline-container-navbar" class="outline-2 text-center navbar navbar-inverse navbar-fixed-top">
<h2 id="navbar"><a id="sec-" name="sec-"></a>Blog</h2>
<div class="outline-text-2" id="text-navbar">
<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#collapsableNavbar">
  <span class="icon-bar"></span>
  <span class="icon-bar"></span>
  <span class="icon-bar"></span>
</button>
<a title="Home" href="../blog.html"><h1 id="navbarTitle" class="navbar-text">Blog</h1></a>
<div class="collapse navbar-collapse" id="collapsableNavbar">
  <ul class="nav navbar-nav">
    <li><a title="Home" href="../index.html"><i class="fas fa-home fa-3x" aria-hidden="true"></i></a></li>
    <li><a title="Article List" href="../articleList.html" class="navbar-text h3">Article List</a></li>
<li><a title="Book List" href="../bookList.html" class="navbar-text h3">Book List</a></li>
    <li><a title="Album List" href="../albumList.html" class="navbar-text h3">Album List</a></li>
    <li><a title="Note Trainer" href="../NoteTrainer/NoteTrainer.html" class="navbar-text h3">Note Trainer</a></li>
  </ul>
</div>
</div>
</div>

<div id="outline-container-Article" class="outline-2">
<h2 id="Article"><a id="sec-" name="sec-"></a>Static Personal Website with Org Mode</h2>
<div class="outline-text-2" id="text-Article">
<p>
<b>Created: <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-06-11 Thu&gt;</span></span></b>
</p>
</div>
<div id="outline-container-ArticleAbstract" class="outline-3">
<h3 id="ArticleAbstract"><a id="sec-" name="sec-"></a>Abstract</h3>
<div class="outline-text-3" id="text-ArticleAbstract">
<p>
In this article I will show you how I built this site using:
</p>
<ul class="org-ul">
<li>Org-mode
</li>
<li>Bootstrap (<a href="https://github.com/marsmining/ox-twbs">ox-twbs</a>)
</li>
<li>HTML(autogenerated) + CSS(minimal) + Javascript (<a href="https://learn.jquery.com/">JQuery</a>)
</li>
</ul>

<p>
You can find the source code of this madness in <a href="https://github.com/benkio/benkio.github.io">here</a>.
</p>

<p>
As you can see it is hosted into Github pages, therefore it's a
static webpage. However, we can get some backend
features using Org and Elisp. Of course, it's anything like a
project who has a real backend available, and some times we would
need to do some proper hacks.
</p>

<p>
Keep reading to discover the pitfalls and advantages of this approach.
</p>
</div>
</div>

<div id="outline-container-ArticleContent" class="outline-3">
<h3 id="ArticleContent"><a id="sec-" name="sec-"></a>Content</h3>
<div class="outline-text-3" id="text-ArticleContent">
<p>
In this section, I will run you through the main features of the site, inserting
links to the code where necessary.
</p>
</div>

<div id="outline-container-ArticleContentFeatures" class="outline-4">
<h4 id="ArticleContentFeatures"><a id="sec-" name="sec-"></a>Features</h4>
<div class="outline-text-4" id="text-ArticleContentFeatures">
</div>
<div id="outline-container-ArticleContentFeaturesHTML" class="outline-5">
<h5 id="ArticleContentFeaturesHTML"><a id="sec-" name="sec-"></a>Autogenerated HTML and Org-mode typing comfort</h5>
<div class="outline-text-5" id="text-ArticleContentFeaturesHTML">
<p>
One of the biggest advantages of choosing org-mode as a
technology is that you will get access to the comfort of writing
a blog using a markdown language. Then, it looks clean and comes
with a lot of features (integrated into Emacs):
</p>
<ul class="org-ul">
<li>It's easy to manipulate: tables, dates, links
</li>
<li>Organize your text in sections
</li>
<li>Create lists like this one and so on
</li>
</ul>

<p>
Basically you can do what you could do in a <code>.md</code> file and
more.
</p>

<p>
That's great!!! But what do you want at the end of the day is the
well-known trinity: HTML, CSS, JS. So, we need a way to generate
at least HTML from that. Luckily, org-mode comes with a native
export system to HTML, with its own CSS too! However, the outcome
is far from being <i>modern</i>.
</p>

<p>
How to make things better? For sure I don't want to mess up with
the CSS: I'm not a frontend dev, plus I learned a long time ago the
pain of web designing. The only other option is to <b>steal it</b>!
Fortunately, I have a go-to option: <span class="underline">Bootstrap</span>.
</p>

<p>
Anyway, Bootstrap comes with its own set of rules and structure.
Aligning the native autogenerated HTML code to that is still
very hard, but apparently someone else had my same idea and he
created an org extension that generates a Bootstrap-friendly HTML
output. This extension is called <a href="https://github.com/marsmining/ox-twbs">ox-twbs</a> and it provides a
command (<code>org-twbs-export-to-html</code>) to compile the org to HTML.
</p>

<p>
In this way I'm writing Org text right now and what you see it's
the final result. I got the responsiveness and all the styling
(almost) for free, icons included (+ <a href="https://fontawesome.com/">fontawesome</a> for the homepage).
</p>
</div>
</div>

<div id="outline-container-ArticleContentFeaturesDynamic" class="outline-5">
<h5 id="ArticleContentFeaturesDynamic"><a id="sec-" name="sec-"></a>Article List and Blog Dynamic Content</h5>
<div class="outline-text-5" id="text-ArticleContentFeaturesDynamic">
<p>
I already told you that this site is static, then how can we
achieve some dynamic behavior?
</p>

<p>
The idea here is to take advantage of the org compilation to
execute some Elisp code (call it server-side if you wish). This
code will create some Js to be embedded into the page itself to
serve as data. Later, on the javascript client-side, we will use
those variables to render the data into the page.
</p>

<p>
Using this method we can access other HTML files, such as this
article page, manipulate their content, and generate our data for
the targeted page. Two examples are The <a href="https://benkio.github.io/blog.html">Blog</a> page and the <a href="https://benkio.github.io/articleList.html">Article
List</a> page.
</p>

<p>
Both occasions, there are two Js arrays, called
<code>htmlArticles</code> and <code>htmlArticlesPaths</code>. The former contains a
subset of the HTML structure (Title and Abstract) of the
Articles, and the latter contains the relative path of them.
Starting from those arrays we can zip it and create the list of
articles: minimal in the case of the <a href="https://benkio.github.io/articleList.html">Article List</a> page and with
some preview in the case of the <a href="https://benkio.github.io/blog.html">Blog</a> page.
</p>

<p>
In addition, in order to achieve some simple sorting, we just
need to store the date into the articles filenames, as you can
see directly from the URL of this page.
</p>

<p>
What described before is achieved by the Elisp code into the file
<a href="https://github.com/benkio/benkio.github.io/blob/master/templates.org">templates.org</a>(omitted for brevity) and then integrated into the
page in this way:
</p>

<div class="org-src-container">

<pre class="src src-org"><span style="color: #008ED1; background-color: #EAEAFF;">#+html: &lt;div id='wrap5' data-include="article5"&gt;&lt;/div&gt;</span>

<span style="color: #008ED1; background-color: #EAEAFF;">#+html: &lt;ul id="pagination" class="pagination pagination-lg"&gt;&lt;/ul&gt;</span>
</pre>
</div>

<p>
After that, we need to add some custom js to treat those variables and
populate the empty article tags:
</p>

<p>
<a id="populateArticlesSnippet" name="populateArticlesSnippet"></a>
</p>
<div class="org-src-container">

<pre class="src src-javascript">#+name: populateArticles
#+begin_src javascript :exports none
<span style="color: #8D8D84;">// </span><span style="color: #8D8D84; font-style: italic;">Pagination 0 based</span>
<span style="color: #0000FF;">const</span> <span style="color: #BA36A5;">htmlArticlesPaginated</span> = htmlArticles.slice(page, page + perPage);
<span style="color: #0000FF;">const</span> <span style="color: #BA36A5;">htmlArticlesPathsPaginated</span> = htmlArticlesPaths.slice(page, page + perPage);

<span style="color: #0000FF;">var</span> <span style="color: #BA36A5;">articleDivs</span> = $(<span style="color: #008000;">"[data-include]"</span>).map(<span style="color: #0000FF;">function</span>() { <span style="color: #0000FF;">return</span> <span style="color: #D0372D;">this</span>.id; });

<span style="color: #0000FF;">var</span> <span style="color: #BA36A5;">articlesZip</span> = [];
<span style="color: #0000FF;">var</span> <span style="color: #BA36A5;">articlesElementsZip</span> = [];

<span style="color: #0000FF;">for</span> (<span style="color: #0000FF;">var</span> <span style="color: #BA36A5;">i</span> = 0; i &lt; htmlArticlesPaginated.length; i++) {
    articlesZip.push([htmlArticlesPaginated[i], htmlArticlesPathsPaginated[i]]);
}

<span style="color: #0000FF;">var</span> <span style="color: #BA36A5;">htmlArticlesTitle</span> = articlesZip.map(<span style="color: #0000FF;">function</span>(<span style="color: #BA36A5;">tuple</span>) {
  <span style="color: #0000FF;">const</span> [<span style="color: #BA36A5;">articleContent</span>, <span style="color: #BA36A5;">articlePath</span>] = tuple;
  <span style="color: #0000FF;">return</span> $($.parseHTML(articleContent)).find(<span style="color: #008000;">"#Article"</span>).wrap(<span style="color: #0000FF;">function</span> (){
    <span style="color: #0000FF;">return</span> <span style="color: #008000;">"&lt;a href='"</span> + articlePath + <span style="color: #008000;">"'&gt;&lt;/a&gt;"</span>
  }).parent();
});

<span style="color: #0000FF;">var</span> <span style="color: #BA36A5;">htmlArticlesAbstract</span> = htmlArticlesPaginated.map(<span style="color: #0000FF;">function</span>(<span style="color: #BA36A5;">articleContent</span>) {
  <span style="color: #0000FF;">return</span> $($.parseHTML(articleContent)).find(<span style="color: #008000;">"#outline-container-ArticleAbstract"</span>);
});

<span style="color: #0000FF;">for</span> (<span style="color: #0000FF;">var</span> <span style="color: #BA36A5;">i</span> = 0; i &lt; htmlArticlesPaginated.length; i++) {
    articlesElementsZip.push([articleDivs[i], htmlArticlesTitle[i], htmlArticlesAbstract[i]]);
}

articlesElementsZip.forEach(<span style="color: #0000FF;">function</span>(<span style="color: #BA36A5;">tuple</span>) {
    <span style="color: #0000FF;">const</span> [<span style="color: #BA36A5;">element</span>, <span style="color: #BA36A5;">title</span>, <span style="color: #0000FF;">abstract</span>] = tuple;
    $(<span style="color: #008000;">"#"</span> + element).html($(<span style="color: #008000;">'&lt;div&gt;'</span>).append(title).append(<span style="color: #0000FF;">abstract</span>));
});

#+end_src
</pre>
</div>

<p>
Obviously, all of this came at a cost, in particular:
</p>
<ul class="org-ul">
<li>In case of an article addition/deletion/renaming, we need to
recompile both pages. This could be a nasty problem if we would
need to add multiple dynamic behaviors to several pages. A possible
workaround could be to trigger the whole site compilation from a
single page, like the root page of the site. It might still take
quite some time and this leads to the next point.
</li>
<li>Not scalable compilation time: if we are going to have hundreds of
articles it might take a long time and space (size of js
variables). A workaround could be to split the articles into
multiple folders, by year or with an archive folder, then keep the
dynamic nature only to a subset of the articles.
</li>
</ul>
</div>
</div>

<div id="outline-container-ArticleContentFeaturesPagination" class="outline-5">
<h5 id="ArticleContentFeaturesPagination"><a id="sec-" name="sec-"></a>Pagination</h5>
<div class="outline-text-5" id="text-ArticleContentFeaturesPagination">
<p>
Pagination is no different from the previous section, in fact, It
takes advantage of the same data.
</p>

<p>
If you take a look closely at the previous <a href="#populateArticlesSnippet">snippet</a> you will see
two additional variables, called <code>page</code> and <code>perPage</code>, used to
slice the starting data arrays to the specific selected
page. Both of those variables are defined in another snippet, in
particular, the <code>page</code> is selected from the URL query string,
meanwhile, the <code>perPage</code> is fixed to 5.
</p>

<p>
Here you can see the complete js code snippet for the pagination:
</p>

<div class="org-src-container">

<pre class="src src-org"><span style="color: #008ED1; background-color: #EAEAFF;">#+NAME: pagination</span>
<span style="color: #555555; background-color: #E2E1D5; text-decoration: underline;">#+BEGIN_SRC javascript :exports none</span>
<span style="color: #0000FF; background-color: #FFFFE0;">const</span><span style="color: #000088; background-color: #FFFFE0;"> </span><span style="color: #BA36A5; background-color: #FFFFE0;">page</span><span style="color: #000088; background-color: #FFFFE0;"> = ((</span><span style="color: #0000FF; background-color: #FFFFE0;">new</span><span style="color: #000088; background-color: #FFFFE0;"> </span><span style="color: #6434A3; background-color: #FFFFE0;">URLSearchParams</span><span style="color: #000088; background-color: #FFFFE0;">(window.location.search).get(</span><span style="color: #008000; background-color: #FFFFE0;">'page'</span><span style="color: #000088; background-color: #FFFFE0;">) || 1) - 1) * 5;</span>
<span style="color: #0000FF; background-color: #FFFFE0;">const</span><span style="color: #000088; background-color: #FFFFE0;"> </span><span style="color: #BA36A5; background-color: #FFFFE0;">perPage</span><span style="color: #000088; background-color: #FFFFE0;"> = 5;</span>
<span style="color: #0000FF; background-color: #FFFFE0;">for</span><span style="color: #000088; background-color: #FFFFE0;"> (</span><span style="color: #0000FF; background-color: #FFFFE0;">var</span><span style="color: #000088; background-color: #FFFFE0;"> </span><span style="color: #BA36A5; background-color: #FFFFE0;">i</span><span style="color: #000088; background-color: #FFFFE0;"> = 0; i &lt; (htmlArticles.length/perPage); i++) {</span>
<span style="color: #000088; background-color: #FFFFE0;">    </span><span style="color: #0000FF; background-color: #FFFFE0;">var</span><span style="color: #000088; background-color: #FFFFE0;"> </span><span style="color: #BA36A5; background-color: #FFFFE0;">active</span><span style="color: #000088; background-color: #FFFFE0;"> = </span><span style="color: #008000; background-color: #FFFFE0;">""</span><span style="color: #000088; background-color: #FFFFE0;">;</span>
<span style="color: #000088; background-color: #FFFFE0;">    </span><span style="color: #0000FF; background-color: #FFFFE0;">if</span><span style="color: #000088; background-color: #FFFFE0;"> ((page/perPage) == i) {</span>
<span style="color: #000088; background-color: #FFFFE0;">        active = </span><span style="color: #008000; background-color: #FFFFE0;">"class='active'"</span><span style="color: #000088; background-color: #FFFFE0;">;</span>
<span style="color: #000088; background-color: #FFFFE0;">    }</span>
<span style="color: #000088; background-color: #FFFFE0;">    $(</span><span style="color: #008000; background-color: #FFFFE0;">"#pagination"</span><span style="color: #000088; background-color: #FFFFE0;">).append(</span>
<span style="color: #000088; background-color: #FFFFE0;">        </span><span style="color: #008000; background-color: #FFFFE0;">'&lt;li '</span><span style="color: #000088; background-color: #FFFFE0;"> + active + </span><span style="color: #008000; background-color: #FFFFE0;">'&gt;&lt;a href="'</span><span style="color: #000088; background-color: #FFFFE0;"> + window.location.href.split(</span><span style="color: #008000; background-color: #FFFFE0;">'?'</span><span style="color: #000088; background-color: #FFFFE0;">)[0] + </span><span style="color: #008000; background-color: #FFFFE0;">'?page='</span><span style="color: #000088; background-color: #FFFFE0;"> + (i+1) + </span><span style="color: #008000; background-color: #FFFFE0;">'"&gt;'</span><span style="color: #000088; background-color: #FFFFE0;"> + (i+1) + </span><span style="color: #008000; background-color: #FFFFE0;">'&lt;/a&gt;&lt;/li&gt;'</span>
<span style="color: #000088; background-color: #FFFFE0;">    );</span>
<span style="color: #000088; background-color: #FFFFE0;">}</span>
<span style="color: #555555; background-color: #E2E1D5; text-decoration: overline;">#+END_SRC</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-ArticleConclusions" class="outline-3">
<h3 id="ArticleConclusions"><a id="sec-" name="sec-"></a>Conclusions</h3>
<div class="outline-text-3" id="text-ArticleConclusions">
<p>
In conclusion, <b><b>DON'T DO WHAT I HAVE DONE</b></b>. I'm sure there are
several solutions that are more convenient than the one I implemented
here, like Wordpress, Blogspot, Blogger&#x2026;
</p>

<p>
Anyway, even if I have to re-implement several well-known frameworks, I
also gain these benefits:
</p>
<ul class="org-ul">
<li>I have the chance to learn org better
</li>
<li>I am free from a specific framework
</li>
<li>It's fun (for me)
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-ShareButtons" class="outline-2">
<h2 id="ShareButtons"><a id="sec-" name="sec-"></a>Share Buttons</h2>
<div class="outline-text-2" id="text-ShareButtons">
<!-- AddToAny BEGIN -->
<hr>
<div class="a2a_kit a2a_kit_size_32 a2a_default_style">
<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
<a class="a2a_button_facebook"></a>
<a class="a2a_button_twitter"></a>
<a class="a2a_button_whatsapp"></a>
<a class="a2a_button_telegram"></a>
<a class="a2a_button_linkedin"></a>
<a class="a2a_button_email"></a>
</div>
<script async src="https://static.addtoany.com/menu/page.js"></script>
<!-- AddToAny END -->

<script type="text/javascript">
$(function() {
  $('#text-table-of-contents > ul li').first().css("display", "none");
  $('#text-table-of-contents > ul li').last().css("display", "none");
  $('#table-of-contents').addClass("visible-lg")
});
</script>
</div>
</div>
</div></div></div>
</body>
</html>
